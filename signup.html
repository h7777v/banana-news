---
layout: "base.njk"
title: "Sign Up"
---
<h1>Sign Up for an Account</h1>

<form id="signupForm">
  <div>
    <label for="email">Email:</label>
    <input type="email" id="email" required>
  </div>
  <div>
    <label for="password">Password:</label>
    <input type="password" id="password" required>
  </div>
  <button type="submit">Create Account</button>
</form>
<button id="google" type="button">Signup with Google</button>
<div id="message"></div>

<p>Already have an account? <a href="/login/">Log In</a></p>

  <script type="module">
  // FIX: Combine all Auth functions/classes into one import statement.
  // This imports all needed functions/classes from the full CDN path.
  import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    GoogleAuthProvider, 
    signInWithPopup 
  } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
  
  // FIX: This is already correct.
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";

  // The rest of your code is now correct for the Modular API
  const provider = new GoogleAuthProvider(); 

  // Your Firebase configuration...
  const firebaseConfig = {
    apiKey: "AIzaSyDPTxdGNRcokbHS9fNVxq2VgO_TJcuDP08",
    // ... (rest of your config)
  };

  // Initialize Firebase and get the Auth service
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const signupForm = document.getElementById('signupForm');
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const messageDiv = document.getElementById('message');

  signupForm.addEventListener('submit', (e) => {
    e.preventDefault(); // Stop the form from reloading the page

    const email = emailInput.value;
    const password = passwordInput.value;

    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // User created successfully!
        messageDiv.innerText = "Account created successfully! Redirecting to login...";
        console.log("New user:", userCredential.user.uid);
        setTimeout(() => {
          window.location.href = "/login/";
        }, 2000); // Redirect after 2 seconds
      })
      .catch((error) => {
        // Handle errors during creation
        const errorMessage = error.message;
        messageDiv.innerText = `Error: ${errorMessage}`;
        console.error("Signup failed:", errorMessage);
      });
  });
  
  document.addEventListener("google", (e) => {
    signInWithPopup(auth, provider)
  .then((result) => {
    // This gives you a Google Access Token. You can use it to access the Google API.
    const credential = GoogleAuthProvider.credentialFromResult(result);
    const token = credential.accessToken;
    // The signed-in user info.
    const user = result.user;

    // You can now access user data like user.displayName, user.email, etc.
    console.log("Signed in as:", user.displayName);
  })
  .catch((error) => {
    // Handle Errors here.
    const errorCode = error.code;
    const errorMessage = error.message;
    // The email of the user's account used.
    const email = error.customData.email;
    // The AuthCredential type that was used.
    const credential = GoogleAuthProvider.credentialFromError(error);
    console.error("Sign-in failed:", errorMessage);
  });
  });
</script>