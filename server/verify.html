<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Verify your email - Banana News</title>
        <script src="adapter.js"></script>
        <link rel="stylesheet" href="../styles/verify.css">
        <link rel="stylesheet" href="../styles/searchresults.css">
    </head>
    <body>
        <div>
            <script>
            var shown = false;
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const parameterValue = urlParams.get('code');
            if(parameterValue==""||parameterValue==null||parameterValue==undefined){
                window.location.href="../"
            } else {
                let done = false
                setInterval(()=>{
                    if(uuid != 0 && done==false){
                        done = true
                        buildReq(3, [parameterValue], "server", 1, 0)
                        setInterval(()=>{
                            if(GetRes(1)){
                                if(GetRes(1)["content"]["status"]==200){
                                    if (!shown) {
                                        document.getElementById("cont").innerHTML = `<img src='../images/pixil-gif-drawing(2).gif' style='float:left;' height='100'>${document.getElementById("cont").innerHTML}`;
                                        shown = true;
                                    }
                                    
                                    document.getElementById("title").innerHTML="Email verification success"
                                    document.getElementById("text").innerHTML='You may proceed to login: <br><button onclick="window.location.href=`../login`">Login</button>'
                                } else if(GetRes(1)["content"]["status"]==403){
                                    document.getElementById("animation").style.display="block";
                                    document.getElementById("title").innerHTML="Email verification failed"
                                    document.getElementById("text").innerHTML='The link you provided was invalid or expired. <br><button onclick="window.location.href=`../`">Back to banana news</button>'
                                } else {
                                    document.getElementById("title").innerHTML="Invalid server reponse"
                                }
                            }
                        }, 5)
                    }
                }, 50)
            }
            </script>
            <script src="../scripts/searchlogic.js"></script>
            <div id="cont">
                <div id='animation' style="display:none;float:left;">
            <div id='banana'>
                <div id='first'></div>
                <div id='second'></div>
                <div id='third'></div>
                <div id='fourth'></div>
                <div id='mouth'></div>
                <div id='eye1'></div>
                <div id='eye2'></div>
                
            </div>
            <div id='mark1'><h2>?</h2></div>
            <div id='mark2'><h2>?</h2></div>
            <div id='mark3'><h2>?</h2></div>
            <div id='mark4'><h2>?</h2></div>
            <div id='mark5'><h2>?</h2></div>
        </div>
                <h1 id="title"></h1>
                <p id="text"></p>
            </div>
        </div>
    </body>
</html>