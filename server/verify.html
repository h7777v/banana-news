<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Verify your email - Banana</title>
        <script src="adapter.js"></script>
        <link rel="icon" href="/images/logosvg.svg">
        <link rel="stylesheet" href="../styles/verify.css">
        <link rel="stylesheet" href="../styles/searchresults.css">
    </head>
    <body>
        <div>
            <script>
            var shown = false;
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const parameterValue = urlParams.get('code');
            let hydro = document.querySelector("#hydro");
            let bn = document.querySelector("#bn");
            if(parameterValue==""||parameterValue==null||parameterValue==undefined){
                window.location.href="../"
            } else {
                let done = false
                setInterval(()=>{
                    if(uuid != 0 && done==false){
                        done = true
                        buildReq(3, [parameterValue], "server", 1, 0)
                        setInterval(()=>{
                            if(GetRes(1)){
                                if(GetRes(1)["content"]["status"]==200){
                                    if (!shown) {
                                        bn.style.display="block";
                                        shown = true;
                                    }
                                    
                                    document.getElementById("title").innerHTML="Email verification success"
                                    document.getElementById("text").innerHTML='You may proceed to login: <br><button onclick="window.location.href=`../login`">Login</button>'
                                } else if(GetRes(1)["content"]["status"]==403){
                                    if (!shown) {
                                        hydro.style.display="block";
                                        shown = true;
                                    }
                                    document.getElementById("animation").style.display="block";
                                    document.getElementById("title").innerHTML="Email verification failed"
                                    document.getElementById("text").innerHTML='The link you provided was invalid or expired. <br><button onclick="window.location.href=`../`">Back to Banana</button>'
                                } else {
                                    document.getElementById("title").innerHTML="Invalid server reponse"
                                }
                            }
                        }, 5)
                    }
                }, 50)
            }
            </script>
            <script src="../scripts/searchlogic.js"></script>
            <div id="cont">
                <img src="../images/4HU3vc.gif" height="100" id="hydro" style="display:none;">
                <img src="../images/pixil-gif-drawing(2).gif" height="100" id="bn" style="display:none;">
                <h1 id="title"></h1>
                <p id="text"></p>
            </div>
        </div>
    </body>
</html>