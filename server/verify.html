<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Verrify your email - Banana News</title>
        <script src="adapter.js"></script>
    </head>
    <body>
        <div>
            <script>
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const parameterValue = urlParams.get('code');
            if(parameterValue==""||parameterValue==null||parameterValue==undefined){
                window.location.href="../"
            } else {
                let done = false
                setInterval(()=>{
                    if(uuid != 0 && done==false){
                        done = true
                        buildReq(3, [parameterValue], "server", 1, 0)
                        setInterval(()=>{
                            if(GetRes(1)){
                                if(GetRes(1)["content"]["status"]==200){
                                    document.getElementById("title").innerHTML="Email verification success"
                                    document.getElementById("text").innerHTML='You may proceed to login: <br><button onclick="window.location.href=`../login`">Login</button>'
                                } else if(GetRes(1)["content"]["status"]==403){
                                    document.getElementById("title").innerHTML="Email verification failed"
                                    document.getElementById("text").innerHTML='The link you provided was invalid or expired. <br><button onclick="window.location.href=`../`">Back to banana news</button>'
                                } else {
                                    document.getElementById("title").innerHTML="Invalid server reponse"
                                }
                            }
                        }, 5)
                    }
                }, 50)
            }
            </script>
            <div>
                <h1 id="title"></h1>
                <p id="text"></p>
            </div>
        </div>
    </body>
</html>