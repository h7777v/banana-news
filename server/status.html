<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Server status - Banana News dev</title>
        <link rel="icon" href="/images/logosvg.svg">
        <script src="adapter.js"></script>
        <script>
            var server = false
            var adapter = false
        </script>
        <script async>
            let done = false
            setInterval(()=>{
                if(uuid != 0 && done==false){
                    done = true
                    var serverLatency
                    var adapterLatency
                    let doneS
                    let doneA
                    const timeServer = performance.now()
                    buildReq(0, [], "server", 1, 0)
                    const timeAdapter = performance.now()
                    buildReq(0, [], "adapter", 2, 0)
                    setInterval(()=>{
                        if(GetRes(1)==undefined||doneS===null){}else{
                            doneS=null
                            serverLatency = Math.round(performance.now() - timeServer)
                            server = true
                            document.getElementById("statusS").innerHTML="Online"
                            document.getElementById("LatencyS").innerHTML=`${serverLatency}ms`
                            document.getElementById("LagS").innerHTML=(serverLatency <= 40) ? "None" : (serverLatency <= 100) ? "Low" : (serverLatency <= 150) ? "Moderate" : (serverLatency <= 1000) ? "Heavy" : "Extreme"
                            document.getElementById("LatencyTitleS").style.display="block"
                            document.getElementById("LatencyS").style.display="block"
                            document.getElementById("LagTitleS").style.display="block"
                            document.getElementById("LagS").style.display="block"
                        }
                        if(GetRes(2)==undefined||doneA===null){}else{
                            doneA=null
                            adapterLatency = Math.round(performance.now() - timeAdapter)
                            adapter = true
                            document.getElementById("statusA").innerHTML="Online"
                            document.getElementById("LatencyA").innerHTML=`${adapterLatency}ms`
                            document.getElementById("LagA").innerHTML=(adapterLatency <= 40) ? "None" : (adapterLatency <= 100) ? "Low" : (adapterLatency <= 150) ? "Moderate" : (adapterLatency <= 1000) ? "Heavy" : "Extreme"
                            document.getElementById("LatencyTitleA").style.display="block"
                            document.getElementById("LatencyA").style.display="block"
                            document.getElementById("LagTitleA").style.display="block"
                            document.getElementById("LagA").style.display="block"
                        }
                    }, 0)
                }
            }, 5)
        </script>
    </head>
    <body>
        <div>
            <h1>Server:</h1>
            <h2>status: </h1>
            <p id="statusS">Unknown</p>
            <h2 id="LatencyTitleS">Latency: </h1>
            <p id="LatencyS">1000ms</p>
            <h2 id="LagTitleS">Lag: </h1>
            <p id="LagS">Unknown</p>
            <h1>Adapter:</h1>
            <h2>status: </h1>
            <p id="statusA">Unknown</p>
            <h2 id="LatencyTitleA">Latency: </h1>
            <p id="LatencyA">1000ms</p>
            <h2 id="LagTitleA">Lag: </h1>
            <p id="LagA">Unknown</p>
            <script>
                document.getElementById("LatencyTitleS").style.display="none"
                document.getElementById("LatencyS").style.display="none"
                document.getElementById("LagTitleS").style.display="none"
                document.getElementById("LagS").style.display="none"
                document.getElementById("LatencyTitleA").style.display="none"
                document.getElementById("LatencyA").style.display="none"
                document.getElementById("LagTitleA").style.display="none"
                document.getElementById("LagA").style.display="none"
            </script>
            <script async>
                setTimeout(()=>{
                    if(server == false){
                        document.getElementById("statusS").innerHTML="Offline"
                    }
                    if(adapter == false){
                        document.getElementById("statusA").innerHTML="Offline"
                    }
                }, 1000);
            </script>
        </div>
    </body>
</html>